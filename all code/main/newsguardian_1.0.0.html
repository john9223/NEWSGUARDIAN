<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>822930bd9a8b49fe9e49e0b4df9f3841</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="bzUFQqfzATjI">
<h1 align="center"><b> üß∞üß∞ NEWSGUARDIAN 1.0.0 üß∞üß∞</b></h1>
<h2
id="-enter-newsguardian-100-your-very-own-source-of-real-time-and-dynamic-fact-checking-and-fake-news-detection-tool">üì∞
Enter Newsguardian 1.0.0, your very own source of real-time and dynamic
fact checking and fake news detection tool.</h2>
<p>
</p>
<h2
id="-newsguardian-is-a-real-time-fake-news-detection-with-several-layers-of-functionalities-this-is-done-keeping-in-mind-the-useful-nature-of-the-given-solution-in-preserving-integrity-and-the-field-of-journalism-the-advantage-of-automated-detection-systems-is-in-its-automation-and-scalability">üì∞
Newsguardian is a real time fake news detection with several layers of
functionalities. This is done keeping in mind the useful nature of the
given solution in preserving integrity and the field of journalism. The
advantage of automated detection systems is in its automation and
scalability.</h2>
</div>
<section id="-we-welcome-you-to-the-colab-notebook"
class="cell markdown" id="E_8nzNjE_UZH">
<h2>üéâ We welcome you to the Colab Notebook!</h2>
</section>
<section
id="-the-functionalities-of-newsguardian-is-demonstrated-in-the-below-schematic-diagram"
class="cell markdown" id="qe3CXU-mDHhJ">
<h3>üü• <strong>The functionalities of Newsguardian is demonstrated in
the below schematic diagram.</strong></h3>
<p><img
src="vertopal_e511eca3328e4d04a8a92ca262a2b4bf/10869886fdab94d0db0ec12145e4473c89898f15.jpg"
alt="fake (1).jpg" /></p>
</section>
<div class="cell markdown" id="AfvLLsjaGECA">
<p>This tool has 3 main functionalities.</p>
<p>
</p>
<ul>
<li><strong>Fact Checking</strong> : The model starting with a given
query using which will be run against millions of documents that are
present in the web, i.e scraping the Internet for documents related to
the given query. The query will be pit against the generated search
results only to then calculate the <strong><em>semantic similarity
score</em></strong> that is based on the pure context of both the
sentences. If the score is greater than the threshold value, then the
result is assigned a higher probability of being Real and vice
versa.</li>
</ul>
<p><em>Note that the threshold value is subject to change as per the
domain, the relevance and the number of results generated per
query.</em></p>
<p>
</p>
<ul>
<li><strong>Profanity detection</strong> : The word profanity primarily
refers to any unparliamentary words that exist however, the model would
also detect <strong><em>hate speech, slurs, words that are acting by
anti-national sentiments</em></strong>.</li>
</ul>
<p>
</p>
<ul>
<li><strong>Spamming the spammer</strong> : We try to text the spammer
back with the original authenticated news which is specified as per the
problem statement.</li>
</ul>
</div>
<div class="cell markdown" id="pzgDY7GnKWeG">
<p>##SO LET'S START!!</p>
</div>
<section id="-part-i---fact-checking--fake-news-verification"
class="cell markdown" id="Zxo1-9hVKlQk">
<h2>üçÄ <strong>Part I - Fact Checking / Fake News
Verification</strong></h2>
</section>
<section id="-installing-all-the-required-libraries"
class="cell markdown" id="KKAGu-i3KeQd">
<h3>üü® Installing all the required libraries</h3>
</section>
<div class="cell code" data-execution_count="13" id="9SysmreA4uFN">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>q sentence_transformers</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>q googlesearch_py</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>q sumy</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>q transformers</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>q spacy</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m spacy download en_core_web_md</span></code></pre></div>
</div>
<section id="-initializing-all-the-required-libraries"
class="cell markdown" id="o4HhqedlLE-U">
<h3>üü® Initializing all the required libraries</h3>
</section>
<div class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="dc-a8Nft2bQA" data-outputId="b95077ac-6638-49b6-8c3a-aef5a21211b5">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer, util</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">&#39;punkt&#39;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> googlesearch <span class="im">import</span> search</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sumy.parsers.html <span class="im">import</span> HtmlParser</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sumy.nlp.tokenizers <span class="im">import</span> Tokenizer</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sumy.summarizers.lsa <span class="im">import</span> LsaSummarizer</span></code></pre></div>
<div class="output stream stderr">
<pre><code>[nltk_data] Downloading package punkt to /root/nltk_data...
[nltk_data]   Unzipping tokenizers/punkt.zip.
/usr/local/lib/python3.9/dist-packages/torch/cuda/__init__.py:497: UserWarning: Can&#39;t initialize NVML
  warnings.warn(&quot;Can&#39;t initialize NVML&quot;)
</code></pre>
</div>
</div>
<section id="-downloading-the-transformer-pretrained-weights"
class="cell markdown" id="K6sJTLPaLIxW">
<h3>üü® Downloading the Transformer pretrained weights</h3>
</section>
<div class="cell markdown" id="_zXVtC0sNWHq">
<p>####ü§ñ A transformer model is a type of neural network architecture
used for natural language processing (NLP) tasks such as language
translation, text classification, and question answering.</p>

<p>####ü§ñ The transformer model is composed of an encoder and a decoder.
The encoder takes in the input sequence and generates a hidden
representation of it, while the decoder takes the encoder's output and
generates the output sequence. Both the encoder and decoder consist of
multiple layers of self-attention and feedforward neural networks.</p>
</div>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:465,&quot;referenced_widgets&quot;:[&quot;72eee46f54104fcc9a6c68c457661464&quot;,&quot;c191688f7eed4121917e48ec50089288&quot;,&quot;23c782039ed84fc5b594f9f6c428f0f6&quot;,&quot;c6ddf312eb8c49b4a696da28c9071fd5&quot;,&quot;fb950936bb484620a56d320c2aaeb05e&quot;,&quot;fb7d5fa29460475ca5cf855d22d9ce4e&quot;,&quot;5dabf6d89f604018b98a79977a7f17ee&quot;,&quot;473ffc25a0d0413597f07456df776bab&quot;,&quot;432a9fcb9cc04313a3cf40e87fbfbbae&quot;,&quot;4d252bf6bca94a5b8cec21c17db78f68&quot;,&quot;ccce6b0104f948c48bf148ce7a213a4c&quot;,&quot;5a99f47b0e9b456c803c19158bc37297&quot;,&quot;5df029bfdac740bb858f04d23336c0e0&quot;,&quot;c92afc54b4d44f5ca59c077507bcb16b&quot;,&quot;c37b5ea1a9cb4cd8ab98a49c56a60993&quot;,&quot;16a022f605be4302a0909592b977088f&quot;,&quot;9b076374c68e496d82b830ee66bd8e3e&quot;,&quot;d320a7831a564bbca653ca566a4d843b&quot;,&quot;ef5292c71e894771a4f30620af77cce3&quot;,&quot;918602f141ff4fcd96c0f3b8d7b1e427&quot;,&quot;11ed0e16d67c486e975bdd68a1fcfbbe&quot;,&quot;721213d97c6c467c8f7a759f7d73da34&quot;,&quot;2a91bc4ee2264c5e9976c9ddaee0ce36&quot;,&quot;a7162688c0f34802b37d16f38faccd9e&quot;,&quot;7c5a051d6bc84f1e8551afb6e4597a08&quot;,&quot;eecdf849feec4e4bb5815f78fb27f9a4&quot;,&quot;8cbb1b0947d54a6a8b585696d138903d&quot;,&quot;06c728b7563249519b8b7deb5b5e1ab4&quot;,&quot;bf106eb5bd4649f8aaf8aab6637485cf&quot;,&quot;988095dd42fa499b8ddbd67dcf9adb64&quot;,&quot;774824c4fec24a36a5394a52f1e04798&quot;,&quot;988f8672934f4f2da5745a37b3d9fc17&quot;,&quot;502628f9461c44aba3832d46e6a93094&quot;,&quot;d0a222b8d65443138f8c0023cab66761&quot;,&quot;da4aa4952c13425095b62f745ca4130c&quot;,&quot;a12b00f3bd5d4f1ea4648d03602b631a&quot;,&quot;42cfccbbec554ee7b1c155edb61a02ae&quot;,&quot;1947bdc2fe5640648a40f72c37e9a54a&quot;,&quot;018f67d7de0a463ab06c31406c2d8bbb&quot;,&quot;e8be62608ddd4c65a36839e3b1b4d06f&quot;,&quot;9397deeeff6a4c39b4ddb8eaf4db5d21&quot;,&quot;ea1387ff24124682a21b52127cf8081e&quot;,&quot;187b735c274048b6a8f451bd20cecd4b&quot;,&quot;dab120abdd48449ab40bfbfe09560731&quot;,&quot;238d705c00f54d609b0fd7c13dabca2f&quot;,&quot;b51a61c000444346b2160ad8ea8987d0&quot;,&quot;4a8f1ea1214c4d92827a7d1304a2a09d&quot;,&quot;19bcde2e747f442782326b6765c32d77&quot;,&quot;f3997bf9a4ee4d8894a12bd846e69554&quot;,&quot;aae05b36275248709f020e92042a2938&quot;,&quot;75fd94c7d82c452a8c77edff9c796ac0&quot;,&quot;60f9195472ae4b82b93d4377a3f82e7a&quot;,&quot;8a7631d44d60441587a57464726159f8&quot;,&quot;06ed58502d3b4aaa83815a4a8ce03a9b&quot;,&quot;968331ae2ec64cc2a5842078eaf4fae5&quot;,&quot;af517d48f9314b6e94a23b160c465fb5&quot;,&quot;eb8fa60e6bf64bb0a023898f0a304b35&quot;,&quot;967f0b2772c445d3938b43dd1fd2fb8b&quot;,&quot;068ef35c9e1f4716b807f39f2a176c64&quot;,&quot;a85e5a9d6207497589788b91175196a3&quot;,&quot;64dd6d06746e4c2096ceebc1aa23ea5b&quot;,&quot;eb6a64e4cee84c649953494d51739491&quot;,&quot;18032ba5255749a8bbdbac472f3e6395&quot;,&quot;64e31b20bcc545b4aded4c1219ec949e&quot;,&quot;8e23b1f6b0de46ec81949d03b106f994&quot;,&quot;40df80f3e7c44ad482d683ec2155564b&quot;,&quot;f56a679c42114ebfab1eb307ac4239e3&quot;,&quot;7ff9bd1c949c41f8936a53c4d971b164&quot;,&quot;058f31a525ec49f6b5ab2fc29ed9296e&quot;,&quot;33e3aea834bb4999bd61ea2270d1fce7&quot;,&quot;c95f4b217aca41e1b508871ae2bd373a&quot;,&quot;491a1255bbb44632b8256ad3276b9df7&quot;,&quot;6804f669af46497c83af27e01f544009&quot;,&quot;c735d8bd774c491d97e32636d67c3de3&quot;,&quot;8d97dc54a0b3463f95d84e68ee2fa4bc&quot;,&quot;9a451fc0f9ea4a1eb4069be93daa75dd&quot;,&quot;ca1084a770c74f32b554e7dbcff5a7f1&quot;,&quot;26503dce27eb488d8dc689139c2483bd&quot;,&quot;1069a804437a49a5ab60001e7ed45f20&quot;,&quot;1aacf979d7b84142b959faf609224617&quot;,&quot;3095ea1a8f4749559d5f0640cc2ffb3d&quot;,&quot;0630aaf0452c492fa0b7e3bf7b31f7c1&quot;,&quot;0d27de3cb5f94179ae13d307ba408ad6&quot;,&quot;75e6ef3315344aaab46d37566eba99be&quot;,&quot;fdaa2c831ab74742980cdc064d9df1ea&quot;,&quot;c2f4f3ffb0794c35bbf67513661ff151&quot;,&quot;5055804b5f774110b296275f86822f4a&quot;,&quot;0f1864832274447295fb65dd55844bbc&quot;,&quot;783adc8e4a75456e911b595479718ee8&quot;,&quot;d4832426ea9742cb8ed09996bb5219ad&quot;,&quot;a7571885cc544255a65b432b77e7cbd3&quot;,&quot;17dc3cade227487a811a194adff3a70c&quot;,&quot;2fe5438c793b4d43932b204b620f1511&quot;,&quot;450385d4dd5e4b66a813553a61b0691f&quot;,&quot;ebaf081c6c29474fa80f1e1ccf999e65&quot;,&quot;d6f8c30cdd9743428be3be026fccf6dc&quot;,&quot;368aacba24ee4d3f9a256844cf807215&quot;,&quot;b1dc28ef9af04ed7a83413695ce7d437&quot;,&quot;ec2f9105692f4de8bcfc6d420c4060b0&quot;,&quot;38605ee080454f53802ee648d91664aa&quot;,&quot;fbb893305b264417a8ff401e475912c7&quot;,&quot;f1e8d96054c54eb4b5799ae7d67aa403&quot;,&quot;ba486f511bf24130ad0ecc55145f3b99&quot;,&quot;d2c854d361334f589540d89e17efa20c&quot;,&quot;0d61836b18804f56bf9f6f8ecbda80f6&quot;,&quot;66458b97ac33475caadda0a507132ebf&quot;,&quot;4c8455b920b64f15a6a4609d78a35ceb&quot;,&quot;f3e3d78d9ba3498b94243ff2dfe87565&quot;,&quot;21bbf84f1ee046dd94cb7982f9bd4510&quot;,&quot;bd6e216411e84731a07ebb1ee08825c1&quot;,&quot;b10d738ddc114567a830ff1176712e3a&quot;,&quot;97c99bcb530d4cb4a4b631cb6a28f0a3&quot;,&quot;f3e523a41b514b2e91f71ca84932e11b&quot;,&quot;f13516eea0524990b53efb24d79afebb&quot;,&quot;b895457170a74afebe5608be58453b4b&quot;,&quot;d42b0e3c0e1448359d2d264916b3505f&quot;,&quot;5bb8e2c9e327467b92fc6f8da6137b97&quot;,&quot;002f2364bd384aafb5a8976bc9c0b582&quot;,&quot;d96e265a5b0e4fe7a5990f2df70ecc9c&quot;,&quot;6656e3ffc5964b5d9da23b73219cbc31&quot;,&quot;ad5ff32b54c641169cef1899f0b13880&quot;,&quot;8757743e4a6b465c84a67cc1ced598b2&quot;,&quot;1010a4d575124a6a94d26345b03bd412&quot;,&quot;5c680663338c44c399c5037c8b618c29&quot;,&quot;22ecd3ad7b5b447c90cf0870732ab0ec&quot;,&quot;7f4b4504be7b4bd1bef1ad4fe4e16610&quot;,&quot;db151d5aa7644ed18040a21dcde82f9c&quot;,&quot;f3f0508591c24932a21d0231618a0d8f&quot;,&quot;f159718f31bd4395b1e49589822d5626&quot;,&quot;baabcfac45a645a4bd05bbd6e420b19e&quot;,&quot;295c0af6b5eb41828c6eaf83dde92bcc&quot;,&quot;2d31d6cf98e2451984a2b6b3025dbf21&quot;,&quot;1579dbee37ec4c678ab0ca9aad611290&quot;,&quot;e2f19761aa504fb5b2d7837de586acb9&quot;,&quot;4b36ea4a64024be6a70a95f7345f3ee7&quot;,&quot;d69f3f28ae32477896bf9a7d8b82d647&quot;,&quot;d79bcc2478ed4a24919e63328e1a021e&quot;,&quot;e13a2ee058cb47aa97230f04e7d9f520&quot;,&quot;47865e63fd98473b91430f51adef8ad9&quot;,&quot;c5a387e27e98418c8298d778db6fff2f&quot;,&quot;ddfafd6506e44f66a09c67a0869f232e&quot;,&quot;cd3221349ab94c9fbf554789e8ebb7fc&quot;,&quot;37d99b40f5044e14b03273533a1dedc8&quot;,&quot;f016d5ccbe4b4c49a8a48aa2d8bec35a&quot;,&quot;39ac3c8d7bb94eccbc7d2db245f2be97&quot;,&quot;6ab6f0523a1e40d297a8b0a41d052bdf&quot;,&quot;4878ee21c177414a9d55e765e256fb50&quot;,&quot;81efe0c2f8ef4956b190df49a517e466&quot;,&quot;4dac739e5eeb4eb88a53b53a67c57272&quot;,&quot;83576e12b9674f5ab427a478f0692594&quot;,&quot;5e7776659d524741a1eed20c2a7cfaa5&quot;,&quot;98141e1c0229496b952618103785811e&quot;,&quot;bd4c831adbe44d7ca2f7cdb3d1e4373f&quot;,&quot;2c91ffb6b6464d95af7d362dc78fb93f&quot;]}"
id="lz31wheU2bQE" data-outputId="ce4794a7-917a-48ab-b625-0ad69d402c4c">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SentenceTransformer(<span class="st">&#39;stsb-roberta-large&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb5"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;72eee46f54104fcc9a6c68c457661464&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb6"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;5a99f47b0e9b456c803c19158bc37297&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb7"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;2a91bc4ee2264c5e9976c9ddaee0ce36&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb8"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d0a222b8d65443138f8c0023cab66761&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb9"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;238d705c00f54d609b0fd7c13dabca2f&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb10"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;af517d48f9314b6e94a23b160c465fb5&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb11"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;f56a679c42114ebfab1eb307ac4239e3&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb12"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;26503dce27eb488d8dc689139c2483bd&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb13"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;783adc8e4a75456e911b595479718ee8&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb14"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;38605ee080454f53802ee648d91664aa&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb15"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b10d738ddc114567a830ff1176712e3a&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb16"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;8757743e4a6b465c84a67cc1ced598b2&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb17"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;1579dbee37ec4c678ab0ca9aad611290&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb18"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;f016d5ccbe4b4c49a8a48aa2d8bec35a&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell markdown" id="PYWOlmfYOeIt">
<p>####ü§ñ The transformer model we used here is known as "RoBERTa" which
has been used in the STS (semantic text similarity) task, which involves
determining the degree of semantic similarity between two sentences.</p>
</div>
<div class="cell markdown" id="S_mY8nqKRxgF">
<p><embed
src="vertopal_e511eca3328e4d04a8a92ca262a2b4bf/78013bea251ddf1ba1d5ef56b90a2ebc107b16ea.bin" /></p>
<p>source from: <a
href="https://www.researchgate.net/figure/The-RoBERTa-model-architecture_fig2_352642553"
class="uri">https://www.researchgate.net/figure/The-RoBERTa-model-architecture_fig2_352642553</a></p>
</div>
<section id="-entering-a-sample-query-to-retrieve-relevant-results"
class="cell markdown" id="1FqNrgAcQ_Zi">
<h3>üü® Entering a sample query to retrieve relevant results</h3>
</section>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Zd67nhadxJcX" data-outputId="e0a04618-f77c-4750-887a-ba7b40423fd1">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for the top 5 websites for a query</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">&quot;Saif ali khan is married to kareena kapoor&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>num_results <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>top_urls <span class="op">=</span> <span class="bu">list</span>(search(query, stop<span class="op">=</span>num_results,tbs<span class="op">=</span><span class="st">&#39;qdr:y&#39;</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_urls)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#bypassing websites that block scraping</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> {<span class="st">&#39;User-Agent&#39;</span>: <span class="st">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3&#39;</span>}</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>texts <span class="op">=</span> []</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(top_urls)):</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  response <span class="op">=</span> requests.get(top_urls[i], headers<span class="op">=</span>headers)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  soup <span class="op">=</span> BeautifulSoup(response.content, <span class="st">&#39;html.parser&#39;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  text <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(<span class="bu">map</span>(<span class="kw">lambda</span> p: p.text, soup.find_all(<span class="st">&#39;p&#39;</span>)))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># texts.append(text)</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  texts.append(text)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;https://indianexpress.com/article/entertainment/bollywood/saif-ali-khan-on-ten-years-of-marriage-with-kareena-kapoor-8214978/&#39;, &#39;https://www.hindustantimes.com/entertainment/bollywood/kareena-kapoor-recalls-why-she-rejected-saif-ali-khan-s-marriage-proposal-twice-101660214696891.html&#39;, &#39;https://www.hindustantimes.com/entertainment/bollywood/when-saif-ali-khan-advised-all-men-to-marry-younger-beautiful-women-called-marriage-with-kareena-kapoor-best-thing-101678359705887.html&#39;, &#39;https://www.filmfare.com/news/bollywood/5-reasons-why-kareena-kapoor-khan-and-saif-ali-khan-are-the-perfect-bollywood-couple-54170.html&#39;, &#39;https://www.ndtv.com/entertainment/how-kareena-kapoor-wished-saif-ali-khan-on-10th-wedding-anniversary-you-and-me-to-eternity-3436588&#39;]
</code></pre>
</div>
</div>
<section
id="-invoking-transformer-and-calculating-the-required-semantic-similarity"
class="cell markdown" id="KtK6YLKhRLYl">
<h3>üü® Invoking Transformer and calculating the required semantic
similarity</h3>
</section>
<div class="cell code" data-execution_count="15" id="4OgsDk4DZwby">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>LANGUAGE <span class="op">=</span> <span class="st">&quot;english&quot;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>SENTENCES_COUNT <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>summaries <span class="op">=</span> []</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(texts)):</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  parser <span class="op">=</span> HtmlParser.from_string(texts[i], <span class="va">None</span>, Tokenizer(LANGUAGE))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  summarizer <span class="op">=</span> LsaSummarizer()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  summarizer.stop_words <span class="op">=</span> [<span class="st">&#39; &#39;</span>]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  summary <span class="op">=</span> summarizer(parser.document, SENTENCES_COUNT)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(f&quot;Summary for website {1}:&quot;)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  result <span class="op">=</span> []</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(summary)):</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(str(summary[i]))</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    result.append(<span class="bu">str</span>(summary[i]))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    str1 <span class="op">=</span> <span class="st">&quot; &quot;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    str1 <span class="op">=</span> str1.join(result)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  summaries.append(str1)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>similarities <span class="op">=</span> []</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="l2oHGkEiZwZD" data-outputId="1727d334-f448-4d8b-cb6a-4b0ea5d0ab54">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the pre-trained model</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">&quot;en_core_web_md&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(summaries)):</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define two example sentences</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  sentence1 <span class="op">=</span> query</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  sentence2 <span class="op">=</span> summaries[i]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get embeddings for the sentences</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  embeddings <span class="op">=</span> [nlp(sentence).vector <span class="cf">for</span> sentence <span class="kw">in</span> [sentence1, sentence2]]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cosine similarity between the sentence embeddings</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  similarity <span class="op">=</span> cosine_similarity(embeddings)[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the similarity score</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(&quot;Similarity score:&quot;, similarity)</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  similarities.append(similarity)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>similarities</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>[0.605448,
 0.61226237,
 0.607823,
 0.5843661,
 0.5056125,
 0.605448,
 0.61226237,
 0.607823,
 0.5843661,
 0.5056125,
 0.605448,
 0.61226237,
 0.607823,
 0.5843661,
 0.5056125,
 0.605448,
 0.61226237,
 0.607823,
 0.5843661,
 0.5056125]</code></pre>
</div>
</div>
<div class="cell markdown" id="0JD8t0elRbhL">
<p>####ü§ñ Taking the Mean of all the similarities we then map it against
a common threshold, to set it as real or fake.</p>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="9UweK7bl2bQQ" data-outputId="c6b37a32-848b-472f-fb73-c32c7089ac96">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>avg <span class="op">=</span> <span class="bu">sum</span>(similarities) <span class="op">/</span> <span class="bu">len</span>(similarities)  <span class="co"># calculate average</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(avg)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.5322330296039581
</code></pre>
</div>
</div>
<section id="-probablistic-assignment-of-fact-authenticity"
class="cell markdown" id="AdsXSOqpSGUV">
<h3>üü® Probablistic assignment of Fact Authenticity</h3>
</section>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="k06btBXS2bQS" data-outputId="4ff5ae5d-06ea-46ff-9c1c-b26df513ef5f">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> avg <span class="op">&lt;</span> threshold :</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(<span class="st">&quot;based on the below sources - &quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(results)):</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      fine <span class="op">=</span> results[i].get(<span class="st">&#39;url&#39;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>      addme.append(fine)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(fine) </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>   <span class="bu">print</span>(<span class="st">&quot;We can classify the news as Fake&quot;</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">&quot;The news is True&quot;</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>      </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The news is True
</code></pre>
</div>
</div>
<div class="cell markdown" id="7GpH2qyXSS8K">
<p>####ü§ñ The given news is termed real or fake.</p>
</div>
<div class="cell markdown" id="wWmOjcOwSbTY">
<p>
</p>
</div>
<section id="-part-ii---profanity-detection" class="cell markdown"
id="ImoX4zNOSb9U">
<h2>üçÄ <strong>Part II - Profanity Detection</strong></h2>
</section>
<section id="-invoking-bart-mnli-transformer" class="cell markdown"
id="ymOzzs-WbBEg">
<h3>üü¶ Invoking BART MNLI Transformer</h3>
</section>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:244,&quot;referenced_widgets&quot;:[&quot;9b3591d1353944c4994f6fa2b8e9d013&quot;,&quot;8c4107b428414b67be6d32d94844b7d0&quot;,&quot;5c140c59b9454aba93dd78f8dcf66fae&quot;,&quot;a6dfa6232bd6417cb258a017d8043dde&quot;,&quot;ca4b6350f4b84a87b78898d82a32d733&quot;,&quot;35fcd23864734d14b55f9ead8f7ea166&quot;,&quot;e62b36fe5b364e1184fe7e010d932cbe&quot;,&quot;c623865058ea4d40a29ad61f1f7968fc&quot;,&quot;c9a1351f8fe64c4dae1ad7fdab5a45ee&quot;,&quot;4d0641dcf0524563a24e89c04300d0fa&quot;,&quot;99153b6e762246aa899083c7f64520a5&quot;,&quot;ac567d4993494a1c92381490fa4aeef6&quot;,&quot;f1b1cc60cb744c2e863fd202bbac1ceb&quot;,&quot;44e262a7ebb449ac9655716fd4917790&quot;,&quot;878ee9aa0c1a452abb6a33c586bd268d&quot;,&quot;06992d893b9f4975ad26a98f77cd8235&quot;,&quot;a1a8a601570e455e82fa8e1598969fd8&quot;,&quot;a5172e029d9049e5bbe298b83a07ef80&quot;,&quot;c48e261804064101b0ed42a6119c52c8&quot;,&quot;58099781a68d494c932e3058a0320651&quot;,&quot;56c3469556f54bc09d706d83faa82b8b&quot;,&quot;cadd78a9b3dd412baac7479ef6deedd5&quot;,&quot;e090b3dfaf7a4cd1ae1ece180cd94f40&quot;,&quot;bce81e969dc84f6cb7ded1582ef03b27&quot;,&quot;5c9cb8a1e15c497e97395fad38403c6c&quot;,&quot;17016f2236a046d28dea41988646af5d&quot;,&quot;c043b220ca5a4b4fb4a89d336be1f9ff&quot;,&quot;dbcfcc31e8a54363a23e3572ac71fa71&quot;,&quot;7bce38009b0843b69d159f27fb54a30c&quot;,&quot;2ef411e795034a64a108a62509fb13e6&quot;,&quot;1020becc5692415fb2e62efbf9d046e6&quot;,&quot;35d44e2e2bf44240a3dc870cad443d3e&quot;,&quot;7b4fd1297a204a7aa091b4de2bd6a35e&quot;,&quot;594dbb83a8a448828476b8a8c56c457f&quot;,&quot;30348d3ff5814dc99be8af61de8aa9f4&quot;,&quot;6c1666c694c04c77b56eee15208f6d82&quot;,&quot;bfb6310025e34db6a0b653a5bf811f07&quot;,&quot;ad01043f24534cf4b716ced9b4839f18&quot;,&quot;7184e748f4a94bfb83a9e542e889e901&quot;,&quot;709bcd8218c5442da7bc194295f6fa95&quot;,&quot;21a3e002af2d497c957a0857bf55a44a&quot;,&quot;a30890e73eea4c0f9a73b06d6193d992&quot;,&quot;0ef9e1d00f2140299d09022f6b00af4c&quot;,&quot;2447bd346ae849ba9350776723517d0f&quot;,&quot;b6bd392d5ed34a4c9874566c02e671c3&quot;,&quot;401f65bfc1c342a8960f858447f51f2d&quot;,&quot;018d2ae698cf4bb3b759e71d8d2da9d0&quot;,&quot;228ef58d7fb243378ac5cf1e24279c2f&quot;,&quot;195ae6faa24a423db759dff2ecb48684&quot;,&quot;ae9cc20d6d1e480a8661845420f494d3&quot;,&quot;d9e0f6c153084a7d9ccb48209010dc83&quot;,&quot;d5dec7dfbb0d43bd93db0ce7ce75b408&quot;,&quot;604258cd01d341bba97ada852a038a1f&quot;,&quot;e1e601971f1b4566921f5d1ac6352f2b&quot;,&quot;e62ad1566a1547a68847c82a46ca144f&quot;,&quot;462c537a2efe42c1bd4501c6aafc089a&quot;,&quot;a6a5e79f59d54c39adf4f0e60603b0a4&quot;,&quot;b0c0208dca7a45c68829a3ef46ab61dd&quot;,&quot;8797f0d115a74f468a54df66a46262a1&quot;,&quot;ae64e7e5a1bc4b43afc616093874aa3b&quot;,&quot;fe67a12666be40779e2817f6c2cfacb1&quot;,&quot;a8b0cc1a5b7543b7b69f019ea97e269f&quot;,&quot;f6f27a8fe54e4ba8a110bd8d7756a594&quot;,&quot;8c51d8f77ea04575a86fa5ad52f7f9a0&quot;,&quot;693e30acbc0a4b4a85e4b2d88e903d51&quot;,&quot;4107f90f80f94ed3b095232a653e1a39&quot;]}"
id="9fuODEFW2lo5" data-outputId="58b3ea56-97da-41fa-8340-3b270c78412b">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> pipeline</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the zero-shot classification pipeline</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>classifier <span class="op">=</span> pipeline(<span class="st">&#39;zero-shot-classification&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>No model was supplied, defaulted to facebook/bart-large-mnli and revision c626438 (https://huggingface.co/facebook/bart-large-mnli).
Using a pipeline without specifying a model name and revision in production is not recommended.
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb30"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;9b3591d1353944c4994f6fa2b8e9d013&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb31"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;ac567d4993494a1c92381490fa4aeef6&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb32"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;e090b3dfaf7a4cd1ae1ece180cd94f40&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb33"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;594dbb83a8a448828476b8a8c56c457f&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb34"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b6bd392d5ed34a4c9874566c02e671c3&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb35"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;462c537a2efe42c1bd4501c6aafc089a&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell markdown" id="FzyMScPcWr0T">
<p>####ü§ñ The transformer model used here is defined under the concept
of Zero-Shot-Classification.</p>

<p>####ü§ñ <strong>Zero-shot classification</strong> is a type of machine
learning technique in which a model is trained to recognize and classify
objects, concepts, or entities that it has not encountered during
training. Instead of being explicitly trained on a specific set of
classes, zero-shot classification models are trained on a more general
set of features and attributes that can be used to recognize a wide
range of classes.</p>

<p>####ü§ñ BART (Bidirectional and Auto-Regressive Transformer) is a
state-of-the-art language model that can be used for zero-shot
classification tasks. BART is a variant of the transformer architecture
that is pre-trained on large amounts of text data and can be fine-tuned
on downstream tasks such as classification.</p>
</div>
<div class="cell markdown" id="rZIgP93WcLX_">
<p><img
src="vertopal_e511eca3328e4d04a8a92ca262a2b4bf/836f331e9c1f2026f05c28f3050ea84c9b7e9a7b.png"
alt="zero-shot-architecture-1.png" /></p>
</div>
<section id="-looking-for-hate-speech-elements-in-a-given-query"
class="cell markdown" id="Eq_hKOkxSy70">
<h3>üü¶ Looking for Hate Speech elements in a given query</h3>
</section>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="nW7tzKNN4J0y" data-outputId="6adeb1e9-fb84-4098-bdd1-e5d9127222f7">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the candidate labels for classification</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;Hate&#39;</span>, <span class="st">&#39;Non-Hate&#39;</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the text to be classified</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> query</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform zero-shot classification</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> classifier(text, labels)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the top candidate label and its score</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>top_label <span class="op">=</span> result[<span class="st">&#39;labels&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>top_score <span class="op">=</span> result[<span class="st">&#39;scores&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> top_label <span class="op">==</span> <span class="st">&#39;hate speech&#39;</span>:</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Text &#39;</span><span class="sc">{</span>text<span class="sc">}</span><span class="ss">&#39; is predicted to be hate speech with a confidence score of </span><span class="sc">{</span>top_score<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Text &#39;</span><span class="sc">{</span>text<span class="sc">}</span><span class="ss">&#39; is predicted to be non-hate speech with a confidence score of </span><span class="sc">{</span>top_score<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Text &#39;Saif ali khan is married to kareena kapoor&#39; is predicted to be non-hate speech with a confidence score of 0.8570337891578674
</code></pre>
</div>
</div>
<section id="-looking-for-profanity-elements-in-a-given-query"
class="cell markdown" id="k0BuoUK2StmZ">
<h3>üü¶ Looking for Profanity elements in a given query</h3>
</section>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="jXbs0iw9STEw" data-outputId="62008fdb-37ff-46f8-8ae6-3eb35299c8ff">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the candidate labels for classification</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;Not Profane&#39;</span>, <span class="st">&#39;Profane&#39;</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the text to be classified</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> query</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform zero-shot classification</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> classifier(text, labels)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the top candidate label and its score</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>top_label <span class="op">=</span> result[<span class="st">&#39;labels&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>top_score <span class="op">=</span> result[<span class="st">&#39;scores&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> top_label <span class="op">==</span> <span class="st">&#39;Profane&#39;</span>:</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Text &#39;</span><span class="sc">{</span>text<span class="sc">}</span><span class="ss">&#39; contains profanity with a confidence score of </span><span class="sc">{</span>top_score<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Text &#39;</span><span class="sc">{</span>text<span class="sc">}</span><span class="ss">&#39; does not contain profanity with a confidence score of </span><span class="sc">{</span>top_score<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Text &#39;Saif ali khan is married to kareena kapoor&#39; does not contain profanity with a confidence score of 0.8394144177436829
</code></pre>
</div>
</div>
<div class="cell markdown" id="5cnU79frh_eK">
<p>####ü§ñ Confidence score indicates the percentage of certainty that
the model has estimated it to be belonging to a particular label.</p>
</div>
<div class="cell markdown" id="vBtQMqXViTCn">
<p>
</p>
</div>
<section id="this-concludes-our-code-hope-you-enjoyed-our-project"
class="cell markdown" id="h2PWcpGviTuZ">
<h2>This concludes our code. Hope you enjoyed our project!</h2>
<h3 id="be-sure-to-fork-and-star-our-repo-on-github---">Be sure to fork
and star our repo on Github! üòÄ üòÄ üòÄ</h3>
</section>
</body>
</html>
